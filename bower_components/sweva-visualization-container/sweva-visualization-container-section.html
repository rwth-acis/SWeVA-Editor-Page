<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../iron-icons/iron-icons.html">
<link rel="import" href="../iron-icon/iron-icon.html">

<!--
An element providing a solution to no problem in particular.

Example:

  <seed-element></seed-element>

Example:

  <seed-element>
    <h2>Hello seed-element</h2>
  </seed-element>

@demo demo/index.html
@hero hero.svg
-->
<dom-module id="sweva-visualization-container-section">
  <template>
    <style>
      :host {
      }

      .content.hidden {
        display: none;
      }

      .collapse-indicator {
        transition: transform linear 0.08s;
        transform-origin: 50% 40%;
      }

      .collapse-indicator.hidden {
        transform: rotate(180deg);
      }

            #header {
                min-height: 30px;
                background-color: #d10000;
                color: #fff;
                padding: 0 8px;
                padding-top: 6px;
                display: flex;
            }

                #header .text {
                    flex: 1 1 0;
                    @apply(--paper-font-subhead);
                    text-overflow: ellipsis;
                    overflow: hidden;
                    width: 100%;
                }

                #header.hidden {
                    border-bottom: 1px solid #fff;
                }
        </style>

        <div id="header" class$="{{collapsedStyle}}">
            <div class="text">
                {{label}}
            </div>
            <div class$="collapse-indicator {{collapsedStyle}}">
                <iron-icon icon="icons:expand-less"></iron-icon>
            </div>
        </div>
        <div class$="content {{collapsedStyle}}">
            <slot>
            </slot>
        </div>
  </template>
  <script>

    class SwevaVisualizationContainerSection extends Polymer.Element {

      static get is() {
        return 'sweva-visualization-container-section';
      }

      static get properties() {
        return {
          label: {
            type: String,
            value: 'Title'
          },
          collapsed: {
            type: Boolean,
            value: false,
            observer: 'collapse'
          },
          collapsedStyle: {
            type: String,
            value: ''
          }
        }
      }

      ready() {
        super.ready();
      }

      connectedCallback() {
        super.connectedCallback();//TOOD fix the attached to connectedCallback
        Polymer.RenderStatus.afterNextRender(this, function() {
          var header = this.shadowRoot.querySelector('#header');
          header.addEventListener("click", this.handleHeaderClicked.bind(this), false);
        });
      }

      // Element Behavior
      collapse(collapsed) {
        if (collapsed) {
          this.collapsedStyle = 'hidden';
        }
        else {
          this.collapsedStyle = '';
        }
      }
      handleHeaderClicked() {
        this.collapsed = !this.collapsed;
      }
    }

    // Register custom element definition using standard platform API
    window.customElements.define(SwevaVisualizationContainerSection.is, SwevaVisualizationContainerSection);
  </script>
</dom-module>