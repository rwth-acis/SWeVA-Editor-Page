<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../paper-dialog/paper-dialog.html">

<dom-module id="sweva-import-export-dialog">
    <template>
        <style>
            :host {
                display: block;
            }

            paper-dialog {
                background: #fff;
                top: 0;
                left: 0;
                bottom: 0;
                right: 0;
                margin: 80px;
                position: fixed;
                max-height: 9000px !important;
                max-width: 9000px !important;
            }

            .dialog-container {
                display: flex;
                flex-direction: column;
                height: 100%;
                width: 100%;
                box-sizing: border-box;
                padding-bottom: 25px;
            }

            .textarea-container {
                flex: 1 1 0;
                position: relative;
                margin-top: 15px;
            }

            textarea {
                height: 100%;
                width: 100%;
                overflow: auto;
                position: absolute;
                top: 0;
                left: 0;
            }

            /* After Polymer 2.0 Update, this style fixes the Material Design Look of paper-button*/
            .buttons paper-button  {
                background-color: var(--paper-indigo-500);
                color: white;
                --paper-button-raised-keyboard-focus: {
                    background-color: var(--paper-pink-a200) !important;
                    color: white !important;
                };
            }

            .buttons paper-button:hover {
                background-color: var(--paper-indigo-100);
            }
        </style>
        <paper-dialog>
            <div class="dialog-container">
                <h2>{{title}}</h2>
                <div class="textarea-container">
                    <textarea spellcheck="false" readonly$="{{isExport}}" value="{{content::input}}"></textarea>
                </div>
                <div class="buttons" style="margin-left: auto">
                    <paper-button dialog-dismiss>Cancel</paper-button>
                    <paper-button dialog-confirm on-click="handleAccept">Accept</paper-button>
                </div>
            </div>
        </paper-dialog>
    </template>
    <script>
            class SwevaImportExportDialog extends Polymer.Element {
                static get is() {
                    return 'sweva-import-export-dialog';
                }

                static get properties() {
                    return {
                        mode: {
                            type: String,
                            value: 'export'
                        },
                        title: {
                            type: String,
                            value: ''
                        },
                        content: {
                            type: String,
                            value: ''
                        },
                        isExport: {
                            type: Boolean,
                            value: false
                        }
                    }
                }

                ready() {
                    super.ready();
                }

                open(){
                    var dialog = this.shadowRoot.querySelector('paper-dialog');
                    if (dialog) {
                        dialog.open();
                        setTimeout(function () {
                            dialog.querySelector('textarea').focus();
                        }, 0);
                    }
                }

                openImport(mode, title) {
                    this.mode = mode;
                    this.title = title;
                    this.content = '';
                    this.isExport = false;
                    this.open();
                }

                openExport(title, content) {
                    this.title = title;
                    this.content = content;
                    this.mode = 'export';
                    this.isExport = true;
                    this.open();
                }

                handleAccept() {
                    if (this.mode != 'export') {
                      this.dispatchEvent(new CustomEvent('accepted', { bubbles: true, composed: true , detail: { mode: this.mode, content: this.content } }));
                    }
                }
            }

            // Register custom element definition using standard platform API
            customElements.define(SwevaImportExportDialog.is, SwevaImportExportDialog);
    </script>
</dom-module>