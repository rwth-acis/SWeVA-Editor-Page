var t="0.8.1";const r="undefined"!=typeof BigUint64Array,e=Symbol(),n=new TextDecoder("utf-16le",{fatal:!0});function o(t,r){let e=new Uint32Array(t)[r+-4>>>2]>>>1;const o=new Uint16Array(t,r,e);if(e<=192)return String.fromCharCode(...o);try{return n.decode(o)}catch{let t="",r=0;for(;e-r>1024;)t+=String.fromCharCode(...o.subarray(r,r+=1024));return t+String.fromCharCode(...o.subarray(r))}}function s(t){const r={};function e(t,r){return t?o(t.buffer,r):"<yet unknown>"}const n=t.env=t.env||{};return n.abort=n.abort||function(t,o,s,i){const a=r.memory||n.memory;throw Error(`abort: ${e(a,t)} at ${e(a,o)}:${s}:${i}`)},n.trace=n.trace||function(t,o,...s){const i=r.memory||n.memory;console.log(`trace: ${e(i,t)}${o?" ":""}${s.slice(0,o).join(", ")}`)},n.seed=n.seed||Date.now,t.Math=t.Math||Math,t.Date=t.Date||Date,r}const i=function(){throw Error("Operation requires compiling with --exportRuntime")};function a(t,e){const n=e.exports,s=n.memory,a=n.table,c=n.__new||i,u=n.__pin||i,y=n.__unpin||i,f=n.__collect||i,p=n.__rtti_base,d=p?function(t){return t[p>>>2]}:i;function b(t){const r=function(t){const r=new Uint32Array(s.buffer);if((t>>>=0)>=d(r))throw Error(`invalid id: ${t}`);return r[(p+4>>>2)+2*t]}(t);if(!(7&r))throw Error(`not an array: ${t}, flags=${r}`);return r}function h(t){const r=new Uint32Array(s.buffer);if((t>>>=0)>=d(r))throw Error(`invalid id: ${t}`);return r[(p+4>>>2)+2*t+1]}function m(t){return 31-Math.clz32(t>>>6&31)}function g(t,r,e){const n=s.buffer;if(e)switch(t){case 2:return new Float32Array(n);case 3:return new Float64Array(n)}else switch(t){case 0:return new(r?Int8Array:Uint8Array)(n);case 1:return new(r?Int16Array:Uint16Array)(n);case 2:return new(r?Int32Array:Uint32Array)(n);case 3:return new(r?BigInt64Array:BigUint64Array)(n)}throw Error(`unsupported align: ${t}`)}function A(t){const r=new Uint32Array(s.buffer),e=b(r[t+-8>>>2]),n=m(e);let o=4&e?t:r[t+4>>>2];const i=2&e?r[t+12>>>2]:r[o+-4>>>2]>>>n;return g(n,2048&e,4096&e).subarray(o>>>=n,o+i)}function w(t,r,e){return new t(_(t,r,e))}function _(t,r,e){const n=s.buffer,o=new Uint32Array(n),i=o[e+4>>>2];return new t(n,i,o[i+-4>>>2]>>>r)}function T(r,e,n){t[`__get${e}`]=w.bind(null,r,n),t[`__get${e}View`]=_.bind(null,r,n)}return t.__new=c,t.__pin=u,t.__unpin=y,t.__collect=f,t.__newString=function(t){if(null==t)return 0;const r=t.length,e=c(r<<1,1),n=new Uint16Array(s.buffer);for(var o=0,i=e>>>1;o<r;++o)n[i+o]=t.charCodeAt(o);return e},t.__newArrayBuffer=function(t){if(null==t)return 0;const r=new Uint8Array(t),e=c(r.length,0);return new Uint8Array(s.buffer).set(r,e),e},t.__getString=function(t){if(!t)return null;const r=s.buffer;if(1!==new Uint32Array(r)[t+-8>>>2])throw Error(`not a string: ${t}`);return o(r,t)},t.__newArray=function(t,r){const e=b(t),n=m(e),o=r.length,i=c(o<<n,4&e?t:0);let a;if(4&e)a=i;else{u(i);const r=c(2&e?16:12,t);y(i);const f=new Uint32Array(s.buffer);f[r+0>>>2]=i,f[r+4>>>2]=i,f[r+8>>>2]=o<<n,2&e&&(f[r+12>>>2]=o),a=r}const f=g(n,2048&e,4096&e);if(16384&e)for(let t=0;t<o;++t){const e=r[t];f[(i>>>n)+t]=e}else f.set(r,i>>>n);return a},t.__getArrayView=A,t.__getArray=function(t){const r=A(t),e=r.length,n=new Array(e);for(let t=0;t<e;t++)n[t]=r[t];return n},t.__getArrayBuffer=function(t){const r=s.buffer,e=new Uint32Array(r)[t+-4>>>2];return r.slice(t,t+e)},[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array].forEach((t=>{T(t,t.name,31-Math.clz32(t.BYTES_PER_ELEMENT))})),r&&[BigUint64Array,BigInt64Array].forEach((t=>{T(t,t.name.slice(3),3)})),t.__instanceof=function(t,r){const e=new Uint32Array(s.buffer);let n=e[t+-8>>>2];if(n<=d(e))do{if(n==r)return!0;n=h(n)}while(n);return!1},t.memory=t.memory||s,t.table=t.table||a,l(n,t)}function c(t){return"undefined"!=typeof Response&&t instanceof Response}function u(t){return t instanceof WebAssembly.Module}async function y(t,r={}){if(c(t=await t))return f(t,r);const e=u(t)?t:await WebAssembly.compile(t),n=s(r),o=await WebAssembly.instantiate(e,r);return{module:e,instance:o,exports:a(n,o)}}async function f(t,r={}){if(!WebAssembly.instantiateStreaming)return y(c(t=await t)?t.arrayBuffer():t,r);const e=s(r),n=await WebAssembly.instantiateStreaming(t,r),o=a(e,n.instance);return{...n,exports:o}}function l(t,r={}){const n=t.__argumentsLength?r=>{t.__argumentsLength.value=r}:t.__setArgumentsLength||t.__setargc||(()=>{});for(let o in t){if(!Object.prototype.hasOwnProperty.call(t,o))continue;const s=t[o];let i=o.split("."),a=r;for(;i.length>1;){let t=i.shift();Object.prototype.hasOwnProperty.call(a,t)||(a[t]={}),a=a[t]}let c=i[0],u=c.indexOf("#");if(u>=0){const r=c.substring(0,u),i=a[r];if(void 0===i||!i.prototype){const t=function(...r){return t.wrap(t.prototype.constructor(0,...r))};t.prototype={valueOf(){return this[e]}},t.wrap=function(r){return Object.create(t.prototype,{[e]:{value:r,writable:!1}})},i&&Object.getOwnPropertyNames(i).forEach((r=>Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(i,r)))),a[r]=t}if(c=c.substring(u+1),a=a[r].prototype,/^(get|set):/.test(c)){if(!Object.prototype.hasOwnProperty.call(a,c=c.substring(4))){let r=t[o.replace("set:","get:")],n=t[o.replace("get:","set:")];Object.defineProperty(a,c,{get(){return r(this[e])},set(t){n(this[e],t)},enumerable:!0})}}else"constructor"===c?(a[c]=(...t)=>(n(t.length),s(...t))).original=s:(a[c]=function(...t){return n(t.length),s(this[e],...t)}).original=s}else/^(get|set):/.test(c)?Object.prototype.hasOwnProperty.call(a,c=c.substring(4))||Object.defineProperty(a,c,{get:t[o.replace("set:","get:")],set:t[o.replace("get:","set:")],enumerable:!0}):"function"==typeof s&&s!==n?(a[c]=(...t)=>(n(t.length),s(...t))).original=s:a[c]=s}return r}var p={instantiate:y,instantiateSync:function(t,r={}){const e=u(t)?t:new WebAssembly.Module(t),n=s(r),o=new WebAssembly.Instance(e,r);return{module:e,instance:o,exports:a(n,o)}},instantiateStreaming:f,demangle:l};function d(t,r,e){return r}function b(t,r,e){return t.exports[`__get${function(t){return t.startsWith("~lib/typedarray/")?((t=t.slice("~lib/typedarray/".length)).startsWith("Big")&&(t=t.slice(3)),t):t}(e)}View`](r)}function h(t,r,e){return t.exports.__newArray(t.getTypeId(e),r)}function m(t){if(!t.startsWith("~lib/array/Array"))throw Error(`${JSON.stringify(t)} is not an array type`);return t.slice("~lib/array/Array<".length,-1)}const g=new Map([["void",{ascToJs:d,jsToAsc:d}],[/^(i|u|f)(8|16|32|64)|[ui]size|bool|externref$/,{ascToJs:d,jsToAsc:d}],["~lib/string/String",{ascToJs:function(t,r,e){return t.exports.__getString(r)},jsToAsc:function(t,r,e){return t.exports.__newString(r)}}],["~lib/typedarray/Int8Array",{ascToJs:b,jsToAsc:h}],["~lib/typedarray/Int16Array",{ascToJs:b,jsToAsc:h}],["~lib/typedarray/Int32Array",{ascToJs:b,jsToAsc:h}],["~lib/typedarray/Uint8Array",{ascToJs:b,jsToAsc:h}],["~lib/typedarray/Uint16Array",{ascToJs:b,jsToAsc:h}],["~lib/typedarray/Uint32Array",{ascToJs:b,jsToAsc:h}],["~lib/typedarray/Int64Array",{ascToJs:b,jsToAsc:h}],["~lib/typedarray/Uint64Array",{ascToJs:b,jsToAsc:h}],["~lib/typedarray/Uint8ClampedArray",{ascToJs:b,jsToAsc:h}],["~lib/typedarray/Float32Array",{ascToJs:b,jsToAsc:h}],["~lib/typedarray/Float64Array",{ascToJs:b,jsToAsc:h}],["~lib/arraybuffer/ArrayBuffer",{ascToJs:function(t,r,e){return t.exports.__getArrayBuffer(r)},jsToAsc:function(t,r,e){const n=t.exports.__new(r.byteLength,t.getTypeId(e));return new Uint8Array(t.exports.memory.buffer,n,r.byteLength).set(new Uint8Array(r)),n}}],[/^~lib\/array\/Array<.+>$/,{ascToJs:function(t,r,e){const n=m(e),o=w(n);return t.exports.__getArray(r).map((r=>o.ascToJs(t,r,n)))},jsToAsc:function(t,r,e){const n=m(e),o=w(n),s=r.map((r=>o.jsToAsc(t,r,n)));return t.exports.__newArray(t.getTypeId(e),s)}}]]),A=new Set;function w(t){for(const[r,e]of g)if("string"!=typeof r){if(r.test(t))return e}else if(r===t)return e;return A.has(t)||(console.warn(`No converter for ${JSON.stringify(t)}, using pass-through`),A.add(t)),{ascToJs:d,jsToAsc:d}}function _(t){var r;return null===(r=w(t))||void 0===r?void 0:r.ascToJs}function T(t){var r;return null===(r=w(t))||void 0===r?void 0:r.jsToAsc}function j(t,r,e){const n=e.parameters.map(_),o=T(e.returnType);return function(...s){if(s.length!=n.length)throw Error(`Expected ${n.length} arguments, got ${s.length}`);const i=s.map(((r,o)=>n[o](t,r,e.parameters[o]))),a=r(...i);return o(t,a,e.returnType)}}function O(t,r,e){const n=e.parameters.map(T),o=_(e.returnType);return(...s)=>{if(s.length!=n.length)throw Error(`Expected ${n.length} arguments, got ${s.length}`);const i=[],a=s.map(((r,o)=>{const s=n[o](t,r,e.parameters[o]);return s!==r&&(t.exports.__pin(s),i.push(s)),s})),c=r(...a);return i.forEach((r=>t.exports.__unpin(r))),o(t,c,e.returnType)}}function U(t,{depth:r=Number.POSITIVE_INFINITY}={}){return r<=0||!t||"object"!=typeof t?t:Object.fromEntries(Object.entries(t).map((([t,e])=>[t,U(e,{depth:r-1})])))}function x(t){const r=WebAssembly.Module.customSections(t,"as-bind_bindings"),e=new TextDecoder("utf8").decode(new Uint8Array(r[0]));try{return JSON.parse(e)}catch(t){throw Error(`Couldnâ€™t decode type descriptor: ${t.message}`)}}class E{constructor(){this.unboundExports={},this.exports={},this.importObject={}}getTypeId(t){if(t in this.typeDescriptor.typeIds)return this.typeDescriptor.typeIds[t].id;throw Error(`Unknown type ${JSON.stringify(t)}`)}getTypeSize(t){if(t in this.typeDescriptor.typeIds)return this.typeDescriptor.typeIds[t].byteSize;throw Error(`Unknown type ${JSON.stringify(t)}`)}_validate(){if(!WebAssembly.Module.exports(this.module).find((t=>"__new"===t.name)))throw Error("The AssemblyScript wasm module was not built with --exportRuntime, which is required.");if(1!==WebAssembly.Module.customSections(this.module,"as-bind_bindings").length)throw new Error("The AssemblyScript wasm module was not built with the as-bind transform.")}async _instantiate(t,r){this.module=await async function(t){if(t=await Promise.resolve(t),"undefined"!=typeof Response&&t instanceof Response){if(WebAssembly.compileStreaming)return WebAssembly.compileStreaming(t);t=await t.arrayBuffer()}return WebAssembly.compile(t)}(t),this._validate(),this.typeDescriptor=x(this.module),this._instantiateBindImportFunctions(r),this.loadedModule=await async function(t,r){return p.instantiate(t,r)}(this.module,this.importObject),this._instantiateBindUnboundExports()}_instantiateSync(t,r){this.module=new WebAssembly.Module(t),this._validate(),this.typeDescriptor=x(this.module),this._instantiateBindImportFunctions(r),this.loadedModule=function(t,r){return p.instantiateSync(t,r)}(this.module,this.importObject),this._instantiateBindUnboundExports()}_instantiateBindImportFunctions(t){this.importObject=U(t,{depth:2});for(const[r,e]of Object.entries(this.typeDescriptor.importedFunctions))for(const[n,o]of Object.entries(e))this.importObject[r][`__asbind_unbound_${n}`]=t[r][n],this.importObject[r][n]=j(this,t[r][n],o)}_instantiateBindUnboundExports(){const t=this.loadedModule.exports;this.exports=U(t,{depth:1});for(const[r,e]of Object.entries(this.typeDescriptor.exportedFunctions))this.exports[r]=O(this,t[r],e)}}async function S(t,r){let e=new E;return await e._instantiate(t,r),e}function I(t,r){let e=new E;return e._instantiateSync(t,r),e}export{g as converters,S as instantiate,I as instantiateSync,t as version};
